Long polling

Долгий опрос (long polling)

Если бы запросы были бесплатными, то никто не заботился бы об эффективности, и каждый мог бы
просто использовать опрос. К сожалению, обработка запросов обходится дорого. Чтобы API 
мог обрабатывать больше запросов, ему необходимо использовать больше серверов, что стоит 
больше денег. Если масштабировать эту громоздкую ситуацию до размеров Google или Facebook
вы заплатите немало за неэффективность. Следовательно, было приложено много усилийй для
оптимизации способа получения клиентом обновлений с сервера.

Одна оптимизация, которая состоит из опроса, называется долгим опросом. При длительном
опросе используется та же идея, что клиент неоднократно запрашивает у сервера обновления,
но с одной изюминкой: сервер не отвечает немедленно. Вместо этого сервер ждет, пока что-то
не изменится, а затем отвечает обновлением.

Давайте вернемся к приведенному выше примеру опроса, но на этот раз с сервером, который
использует трюк с долгим опросом.

Это довольно умная техника. Он подчиняется правилу, что клиент отправляет первоначальный
запрос, в то же время пользуясь тем фактом, что не существует правила, запрещающего
серверу медленно отвечать. Пока и клиент, и сервер согласны с тем, что сервер будет удерживать
запрос клиентам, и клиент может поддерживать свое соединение с сервером открытым, он будет
работать.

Каким бы изобретательным ни был долгий опрос, у него тоже есть некоторые недостатки.
Мы пропустим технические детали, но есть проблемы, например, сколько запросов сервер может
удерживать за раз или как восстановить, если клиентили сервер потеряют соединение.
А пока мы скажем, что для некоторых сценариев ни одна из форм опроса не подходит.
